{% extends "chat/base.html" %}
{% load static %}
{% block content %}
  <div class="content-section">
    <h3>Chat Room</h3>
    <div class="chat-box" id="chatContainer">
      <!-- Chat Messages -->
      {% for comment in comments %}
        {% include "chat/_comment.html" with comment=comment %}
      {% endfor %}
    </div>
    {% if user.is_authenticated %}
      <form id="commentForm" method="POST" action="{% url 'comment-create' %}" class="mt-3" data-authenticated="{{ user.is_authenticated|yesno:'true,false' }}">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Post Comment</button>
      </form>
    {% else %}
      <p>You must be <a href="{% url 'login' %}">logged in</a> to post a comment.</p>
    {% endif %}
  </div>
{% endblock content %}

{% block scripts %}
  <script src="{% static 'chat/js/chat.js' %}"></script>
  <script>
    window.onload = function() {
      const chatContainer = document.getElementById('chatContainer');
      chatContainer.scrollTop = chatContainer.scrollHeight;
    };
  </script>
{% endblock scripts %}